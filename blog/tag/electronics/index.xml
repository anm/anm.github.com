<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Alistair MacLeod, MM0HAI: Posts tagged electronics]]></title>

  <link href="http://mm0hai.net/blog/tag/electronics/index.xml" rel="self"/>
  <link href="http://mm0hai.net/"/>
  <updated>2012-08-01T03:28:26+01:00</updated>
  <id>http://mm0hai.net/blog/tag/electronics</id>
  <author>
    <name><![CDATA[Alistair N. MacLeod]]></name>
  </author>

  
  <entry>
    <title type="html"><![CDATA[Ebay MC34063 based USB car PSU]]></title>
    <link href="http://mm0hai.net/blog/2012/08/01/Message-to-an-ebay-seller.html"/>
    <updated>2012-08-01T00:00:00+01:00</updated>
    <id>http://mm0hai.net/blog/2012/08/01/Message-to-an-ebay-seller</id>
    <content type="html"><![CDATA[<p>I bought this on ebay for £1.17 including postage, but it was worse than my low expectations.</p>

<p><a href="http://www.flickr.com/photos/mm0hai/7688389090/" title="MC34063 based USB car charger by mm0hai, on Flickr"><img src="http://farm8.staticflickr.com/7249/7688389090_2b5c3ce8ca_n.jpg" width="319" height="320" alt="MC34063 based USB car charger"></a></p>

<p><a href="http://www.flickr.com/photos/mm0hai/7688389772/" title="MC34063 based USB car charger by mm0hai, on Flickr"><img src="http://farm9.staticflickr.com/8430/7688389772_f9b45bed93_n.jpg" width="320" height="291" alt="MC34063 based USB car charger"></a></p>

<p><a href="http://www.flickr.com/photos/mm0hai/7688390396/" title="MC34063 based USB car charger by mm0hai, on Flickr"><img src="http://farm9.staticflickr.com/8005/7688390396_f8834ba3ba_z.jpg" width="640" height="351" alt="MC34063 based USB car charger"></a></p>

<p><a href="http://www.flickr.com/photos/mm0hai/7688390784/" title="MC34063 based USB car charger by mm0hai, on Flickr"><img src="http://farm9.staticflickr.com/8152/7688390784_86e180f45b.jpg" width="500" height="358" alt="MC34063 based USB car charger"></a></p>

<p><a href="http://www.flickr.com/photos/mm0hai/7688391162/" title="MC34063 based USB car charger by mm0hai, on Flickr"><img src="http://farm8.staticflickr.com/7258/7688391162_0e23a40901.jpg" width="500" height="401" alt="MC34063 based USB car charger"></a></p>

<p>Here's what I said to the seller:</p>

<p>I have just tested this item and found it does not work.</p>

<p>It is meant to supply 5V at up to 1A. In reality, it outputs 4.6V with no
load, and this falls rapidly to 4.3V at 0.1A and only 2.4V at 0.8A.  This is
not sufficient to charge USB devices, which is what the product is intended
for.</p>

<p>Furthermore, this is not just a faulty unit but an inadequate design. The
MC34063 dc-dc converter IC used can supply a maximum of 750mA in the
configuration used, so it is impossible for the supply to give 1A. The
specifications given are wrong.</p>

<p>The product also lacks a fuse. This is a basic safety precaution and without
it the charger could cause a fire.</p>

<p>This product is dangerous and does not meet its specification. You should stop
selling it.</p>

<p>Please refund.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[How to kill a MOSFET]]></title>
    <link href="http://mm0hai.net/blog/2012/07/09/How-to-Kill-a-MOSFET.html"/>
    <updated>2012-07-09T00:00:00+01:00</updated>
    <id>http://mm0hai.net/blog/2012/07/09/How-to-Kill-a-MOSFET</id>
    <content type="html"><![CDATA[<p>I've been making a constant current load for testing power supplies and solar
panels. I've killed two MOSFETs so far and now learned something about why.</p>

<p>Firstly, the obvious. Voltage, (V<sub>gs</sub> and V<sub>ds</sub>) must be
within limits. The same for current, I<sub>d</sub>. There is also the power
limit given by the maximum junction temperature. I calculated this limit given
the T<sub>j (max)</sub>, the ambient temperature and the thermal resistance
from junction to case, R<sub>θjc</sub>. I then operated my circuit within
these limits and could not understand why the MOSFET was dying.</p>

<p>When I looked at the safe operating area (SOA) graph in the datasheet I found
values much smaller than expected from my calculations. I thought the SOA was
limited only by the maximum voltage current and temperature as calculated with
the R<sub>θjc</sub>, but it turns out there are other thermal limits.</p>

<p>These are particularly notable in the transistor I was using, the <a href="http://www.infineon.com/dgdl/IPB114N03L_rev1.02.pdf?folderId=db3a30431a5c32f2011a809773886508&amp;fileId=db3a30431b3e89eb011bb1511cce0734">IPP114N03L
G</a>.</p>

<p><img alt="IPP114N03L G" src="http://i.stack.imgur.com/2Gsr6.gif" /></p>

<p>Note the steep limits to the right, severely limiting current at higher
voltages. This was the region I was trying to operate in.</p>

<p>I think the problem is caused be high thermal gradients causing expansion and
cracking of the die. This explains the quiet pop I heard when one failed - the
silicon cracked. The thermal resistance seems like more of an average limit -
if the whole die is at a similar temperature it applies. Temperature variation
over the die seems to be higher in FETs designed for switchmode power
supplies. They are optimised for on-off switching and can't cope with
operation in this linear region. BJTs suffer from second breakdown, which
limits the SOA. MOSFETs are not meant to do this but this seems to be a
similar limit.</p>

<p>Moral of the story: don't trust the headline figures. Sometimes these seem to
be made up by the marketing department. Consult the SOA and give the limits a
wide berth.</p>

<p>I learnt most of this from <a href="http://electronics.stackexchange.com/questions/35352/apparent-inconsistency-of-mosfet-power-rating-in-datasheet-soa-v-max-power">my
question on stackexchange</a>.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Testing a Maplin Solar Briefcase and Maximum Power Point]]></title>
    <link href="http://mm0hai.net/blog/2012/06/27/Maplin-Solar-Briefcase.html"/>
    <updated>2012-06-27T00:00:00+01:00</updated>
    <id>http://mm0hai.net/blog/2012/06/27/Maplin-Solar-Briefcase</id>
    <content type="html"><![CDATA[<p>I was in Maplin a while ago and saw a 5W solar panel for sale for £15. I
bought it with a vague idea of using it to power <a href="/radio">my radio</a>
on <a href="/sota">expeditions</a> but mostly just for interest and to learn.</p>

<p>I didn't know anything about photovoltaics at the time and I decided to test
the panel and try to work out what it did. I set it up in full sunlight,
pointing straight at the sun. I measured the voltage and current output when
loaded with various resistors. I then tried the same thing under some halogen
light bulbs. Don't trust the figures too much as I was using <a
href="/blog/2012/05/21/Multimeters-available-in-UK.html">cheap multimeters</a>, one
of which I later discovered changed its readings when bent.</p>

<p><img src="/res/2012-06-27-Maplin-Solar-Briefcase/sun.png">
<img src="/res/2012-06-27-Maplin-Solar-Briefcase/lamp.png"></p>

<p>The maximum power output is less than 2W, when pointed directly at the sun on
a clear day and with a nearly optimal load. I was not impressed.</p>

<p>There is a point on the VI curve where maximum power is extracted but I could
not see any simple way to optimise the load for this. Under different lighting
both the voltage and current of the maximum power point (MPP) change.</p>

<p>I decided to read up on solarvoltaics and maximum power point tracking (MPPT)
which someone had mentioned to me. The wikipedia page on <a
href="http://en.wikipedia.org/wiki/Maximum_power_point_tracking">MPPT</a>
shows this plot of the VI curves from a solar cell model. Reassuringly <a
href="/res/2012-06-27-Maplin-Solar-Briefcase">my data</a> follows this general
shape.</p>

<p><img
src="http://upload.wikimedia.org/wikipedia/commons/d/d8/Solar-Cell-IV-curve-with-MPP.png"
alt="VI curves of model solar cell."/></p>

<p>At this point I started designing a MPPT, but for this panel it is not
useful. The maximum MPP is at around 13V, the minimum MPP worth considering is
around 11V. The power loss of maintaining a fixed 13V out irrespective of
irradiance rather than adapting is lower than that of inserting a switch mode
converter.</p>

<p>I now have a 15W ET Solar panel which exceeds its power specification. I've
not done much testing on it yet but I'll be using it in my touring bike setup
which I'm working on now.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Cheap but not rubbish multimeters available in the UK]]></title>
    <link href="http://mm0hai.net/blog/2012/05/21/Multimeters-available-in-UK.html"/>
    <updated>2012-05-21T00:00:00+01:00</updated>
    <id>http://mm0hai.net/blog/2012/05/21/Multimeters-available-in-UK</id>
    <content type="html"><![CDATA[<p>I used to have only cheap and nasty multimeters, but Dave Jones of the EEVBlog
convinced me that it was worth getting a <a
href="http://www.youtube.com/watch?v=ZoeUgMFLyAw">half decent</a> one. I like
his videos; they are worth watching to learn about meters in general as well
as the specific ones he reviews.</p>

<p>I spent some time looking for where I could get good brand meters here for not
too ridiculous prices (relative to the US and Australia). I made a <a
href="https://docs.google.com/spreadsheet/ccc?key=0AlSnQD_VeghadEpwSmQ5cFZRQkM5OWxxSjUwZm83OHc">spreadsheet
of Amprobe, Extech and UNI-T meters between £25 and about £70 and where you
can buy them</a>. Maybe some of the other brands available in the UK are a
better deal but I have no data on their quality.</p>

<p>I've now ordered an Extech EX330.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Teardown: Vivitar Charger for Canon NB2L Battery]]></title>
    <link href="http://mm0hai.net/blog/2012/03/14/Vivitar-lithium-battery-charger.html"/>
    <updated>2012-03-14T00:00:00+00:00</updated>
    <id>http://mm0hai.net/blog/2012/03/14/Vivitar-lithium-battery-charger</id>
    <content type="html"><![CDATA[<p>I bought this battery charger with a Canon EOS 350D, my first SLR. I wanted to
check if it was any good before I trusted it with a new battery. I am designing
a power system for my bike at the moment and have been reading about batteries
and methods of charging them so I am interested to see how it works and need
to decide whether to use it on my bike or to make my own charger.</p>

<p><a href="http://www.flickr.com/photos/58967572@N03/6838509368/" title="Vivitar charger for Canon NB2L lithium battery - front case by mm0hai, on Flickr"><img src="http://farm8.staticflickr.com/7178/6838509368_63b77a3b61.jpg" width="343" height="500" alt="Vivitar charger for Canon NB2L lithium battery - front case"></a></p>

<h1>Taking it Apart</h1>

<p>One of the first things I noticed was the missing components. The filter
inductors and capacitors on the mains input are missing. These components are
important in a switching power supply to avoid transmitting noise over the HF
spectrum. Probably what has happened is they were put in to meet regulator
requirements, then once the design had been approved they were removed to save
money - most people would not notice. This is really nasty and poor quality,
and probably illegal.</p>

<p><a href="http://www.flickr.com/photos/58967572@N03/6984633733/" title="Vivitar charger for Canon NB2L lithium battery - Missing filter inductors by mm0hai, on Flickr"><img src="http://farm8.staticflickr.com/7182/6984633733_4d0d050b5d.jpg" width="500" height="375" alt="Vivitar charger for Canon NB2L lithium battery - Missing filter inductors"></a></p>

<p><a href="http://www.flickr.com/photos/58967572@N03/6984634431/" title="Vivitar charger for Canon NB2L lithium battery - Missing components by mm0hai, on Flickr"><img src="http://farm8.staticflickr.com/7182/6984634431_111b073a25.jpg" width="473" height="500" alt="Vivitar charger for Canon NB2L lithium battery - Missing com-pents"></a></p>

<p>There is no DC converter chip or microcontroller - it is made from discrete
components and a comparator IC.</p>

<p>There are some more <a
href="http://www.flickr.com/photos/58967572@N03/sets/72157629225738410/">photos
on flickr</a>.</p>

<h1>Correctness</h1>

<p>Does the charger correctly implement a charging algorithm which is good for
the battery?</p>

<p>I investigated the output by loading it with resistors. I powered the charger
with the DC "car charger" input rather than the mains.</p>

<p><img src="/res/2012-03-14-Vivitar-lithium-battery-charger/VI-curve.png"
alt="Graph of current and voltage output of charger with different loads. A table of this data is linked from this page."></p>

<p>The data shown above are <a
href="/res/2012-03-14-Vivitar-lithium-battery-charger/VI-curve">here</a>.</p>

<p>The charger supplies 0.57A until the voltage reaches somewhere between 7.35
and 8.22 volts and then eventually settles down to a constant voltage of 8.39
volts.</p>

<p>The battery I have is 7.2V, 1200mAh (more than the original battery). 0.57A
gives a charge rate of 0.78C. Between 0.2 and 0.7 C is recommended by [2] so
this seems quite reasonable. I don't have a datasheet for the battery so I
will assume the typical peak voltage of 4.2V / cell, 3.6V nominal. This means
the maximum voltage from the charger should be 8.4V, so it is within a +/-
50mV tolerance[1]. Within the normal charging range, it seems to do the right
thing.</p>

<p>However, typically when a cell is discharged to below about 2.5V, it must be
charged at 0.1C or less until it reaches 3V [3]. The charger is happy to
supply 0.78C at 4.93V, or 2.47V / cell. It seems the charger could damage
batteries which are severely discharged, perhaps by self discharge from being
stored for some time.</p>

<p>The other difficulty is when to terminate the charge. This should happen when
charging current drops to something like 10% to 3% of the peak charge current,
depending on which source I believe. That is 17mA minimum anyway, and I did
not measure that low, so I don't know what the charger does. It is still
charging at 42mA though. Some sources recommend a 1h timer to limit the
constant voltage phase. It looks like the charger doesn't have this. One way
to simplify the termination requirement could be to use a voltage less than the
peak, which this charger seems to do by 10mV. This might avoid overcharging
but not fully charge the battery. I don't know for sure though.</p>

<p>I also note that the charger does not make use of the temperature terminal on
the battery.</p>

<h1>Efficiency</h1>

<p>At 14V in and 0.57A, 7.32V out, efficiency was 68%. That's rather
disappointing. I think 95% should be possible, or at least 90%. I got a rough
idea of this from the datasheet for the MAX1556 - it claims around 95%
efficiency at 600mA, 5V in, 3.3V out.</p>

<h1>Conclusion</h1>

<p>The charger is probably adequate if the battery is not discharged too far, it
is supervised, and the battery is not left in the charger for too long. I will
use it for now but would really prefer something better.</p>

<h1>References</h1>

<ol>
<li>http://batteryuniversity.com/learn/article/charging_lithium_ion_batteries</li>
<li>https://www.powerstream.com/li.htm</li>
<li>http://www.ka7oei.com/ft817_roar.html</li>
</ol>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[SGC SG-211 Mini Smartuner Teardown]]></title>
    <link href="http://mm0hai.net/blog/2011/06/02/SGC-211-autotuner.html"/>
    <updated>2011-06-02T00:00:00+01:00</updated>
    <id>http://mm0hai.net/blog/2011/06/02/SGC-211-autotuner</id>
    <content type="html"><![CDATA[<p>My<sup>1</sup> SGC autotuner had an accident when I stupidly put it down on a
bench. The boat heeled and it landed on the connector, bending it. Luckily the
connector was mounted on the case and wired up, rather than soldered directly
to the board, so there was no damage other than a bent box. I took it apart
so I could straighten it out and thought I might as well take some photos
while I was at it.</p>

<p>The item in question is an <a
href="http://www.sgcworld.com/211ProductPage.html">SG-211</a>. I'm not going
to review it or say much other than it is pretty good and the case is soft
aluminium.</p>

<p><a rel="nofollow" href="http://www.flickr.com/photos/58967572@N03/5788517160/" title="Top of board"><img src="http://farm3.static.flickr.com/2327/5788517160_677a9ff43e_z.jpg" width="640" height="428" alt="Top of board"></a></p>

<p><a rel="nofollow" href="http://www.flickr.com/photos/58967572@N03/5788523098/" title="Bottom of board"><img src="http://farm4.static.flickr.com/3273/5788523098_208ab1258e_z.jpg" width="640" height="441" alt="Bottom of board"></a></p>

<p>The relays are interesting. I have been meaning to design an automatic ground
tuner for my <a
href="/blog/2011/03/25/HF-Bicycle-Mobile-Experiment-Part-3.html">bike</a> but
one problem I have is the inability to find any latching relays. It seems SGC
either had their own made, or have had some branded to hide where they get
these mythical devices.</p>

<p><a rel="nofollow" href="http://www.flickr.com/photos/58967572@N03/5787968241/" title="Custom relays?"><img src="http://farm3.static.flickr.com/2440/5787968241_e4bbc34dee_z.jpg" width="640" height="236" alt="Custom relays?"></a></p>

<p><a rel="nofollow" href="http://www.flickr.com/photos/58967572@N03/5787972187/" title="Bottom half of case"><img src="http://farm6.static.flickr.com/5230/5787972187_20fb28eaa0_z.jpg" width="640" height="436" alt="Bottom half of case"></a></p>

<p>The white wire is connected to a front panel toggle switch which was added by
SGC. The new switch disables retuning to avoid a problem where it would retune
in the middle of an over. I'm not sure if the uninsulated wires above this are
part of the mod. I hope they are not fixing a bad board. The switch is useful
but I'm a bit concerned about what this will do for durability. The controller
is a PIC.</p>

<p><a rel="nofollow" href="http://www.flickr.com/photos/58967572@N03/5788529612/" title="PIC"><img src="http://farm6.static.flickr.com/5264/5788529612_7265d6aa5f_z.jpg" width="415" height="640" alt="PIC"></a></p>

<p>A reference / dummy load?</p>

<p><a rel="nofollow" href="http://www.flickr.com/photos/58967572@N03/5787974261/" title="Reference / load?"><img src="http://farm6.static.flickr.com/5229/5787974261_2a675e013d_m.jpg" width="240" height="149" alt="Reference / load R?"></a></p>

<p>--</p>

<p><sup>1</sup> Actually borrowed, but he'll never know my bending was that good. :-)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[My introduction to the Arduino platform]]></title>
    <link href="http://mm0hai.net/blog/2011/05/25/Arduino-Getting-started-with-Seeeduino.html"/>
    <updated>2011-05-25T00:00:00+01:00</updated>
    <id>http://mm0hai.net/blog/2011/05/25/Arduino-Getting-started-with-Seeeduino</id>
    <content type="html"><![CDATA[<p>I have been meaning to do several microcontroller based projects for some time
now. Ideally I wanted to do it without spending any money so I decided to make
myself a PIC programmer with some samples from Microchip. This would also make
the process more interesting.</p>

<p>The plan was to make a <a href="http://usbpicprog.org/">usbpicprog</a> and
bootstrap it with a serial port based programmer using an old computer.  I
bought all the parts, including copper clad board and ferric chloride but
never quite got round to doing it. This was in part because I was not very
keen to have to work with ferric chloride and I didn't want to dissolve the
sink.</p>

<p>Meanwhile, I had been hearing about the Arduino more and more. Initially I
ignored it as something for artists and people who didn't know what they were
doing. I had spent some time at university learning about and using real
microcontrollers with none of this boot loader nonsense so I did not think I
needed such things. Then I realised that being leet enough not to require
simplification did not make quicker development a bad thing. :-) I decided I
had wasted enough time and just wanted to get something done, so I bought an
Arduino.</p>

<p><img src="http://farm6.static.flickr.com/5223/5773580603_eee48af87b.jpg"
width="500" height="375" alt="Seeeduino and ethernet shield"></p>

<p>I actually chose the seeedunio, an Arduino clone. The design is open so this
is allowed and in fact there are some improvements made in the
seeeduino. Primarily I chose it though because it was the cheapest. I still
don't like the idea of paying decapounds for a single basic microcontroller
and some soldering. I also ordered an ethernet shield, which is what an
expansion card is called in the Arduino world. These arrived yesterday.</p>

<p>It took me longer than I would have liked to get started, with the blinking LED
hello world of microcontrollers, because there were no instructions about the
correct settings. After some googling and trial and error I determined that I
had to set the reset switch on the board to auto and, in the Arduino IDE, set
the board type to <type>Deumilanove or Nano w/ ATmega328</type>.  After that
I very quickly had it beaconing my callsign on the board mounted LED attached
to pin 13. So far quite reasonable.</p>

<p>Then I decided to plug in the ethernet board and run the example programs.  I
had to stick all the source files in the same directory and change the ip
address and then I was pinging the board. It took only a few minutes. This I
thought was pretty ridiculous. Then I used the web server program. It
worked. I couldn't really believe this - this did not seem like electronics at
all. I would expect this to have taken weeks of debugging, loose wires, errors
in PCB design, software bugs and frustration but here it was working in a few
minutes with no test gear in sight. I have certainly confirmed my get things
done faster conjecture.</p>

<p>It was not quite as good though when I wanted to connect stuff up to it. The
board did not come with a data sheet and I could not find much at all online.
In the end I went to Atmel's web site and downloaded the datasheet for the
ATmega328P on my board. Included below are some useful figures from it.</p>

<h1>Reference</h1>

<h2>Seeeduino - Summary of Initial Setup</h2>

<p>I am using the Seeeduino V2.21 which is also marked ARD128D2P.</p>

<p>It uses the ATmega328P.</p>

<p>This is the error I got initially:</p>

<p><code>avrdude: stk500_disable(): protocol error, expect=0x14, resp=0x00</code></p>

<p>The solution:</p>

<ul>
<li>Move reset switch to auto</li>
<li>Set board type to <code>Deumilanove or Nano w/ ATmega328</code>.</li>
</ul>


<h1>ATmega328P Data</h1>

<h2>Absolute Maximums</h2>

<table>
<tr><td>Operating Temperature</td><td>-55°C to +125°C</td></tr>
<tr><td>Voltage on any Pin except RESET with respect to Ground</td> <td>-0.5V to VCC+0.5V</td></tr>
<tr><td>Maximum Operating Voltage</td><td>6.0V</td></tr>
<tr><td>DC Current per I/O Pin</td><td>40.0mA</tr>
<tr><td>DC Current VCC and GND Pins</td><td>200.0mA</td></tr>
</table>


<h2>Programming</h2>

<p>The Arduino environment uses C but with some magic, see
<a href="http://arduino.cc/en/Hacking/BuildProcess">Arduino Build Process</a>.</p>

<h2>Ethernet board</h2>

<p>It's ENC28J60 based. This is not the same as the official one, which uses the
Wiznet W5100.</p>

<p>Bought from <a
href="http://www.ekitszone.com/Products/4-enc28j60-ethernet-shield-for-arduino.aspx">ekitszone</a>.
Looks well made and works.</p>
]]></content>
  </entry>
  
</feed>
